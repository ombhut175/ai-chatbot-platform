<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Widget Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        .section {
            margin: 40px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
        }
        .config-section {
            margin: 20px 0;
            padding: 20px;
            background: #e8f4f8;
            border-radius: 8px;
            border: 1px solid #b3e0f2;
        }
        .config-item {
            margin: 10px 0;
        }
        label {
            font-weight: 600;
            margin-right: 10px;
            display: inline-block;
            width: 120px;
        }
        select, input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        button:hover {
            background: #5a67d8;
        }
        .api-section {
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 8px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .instructions {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chatbot Widget Integration Test</h1>
        <p class="subtitle">Test and configure your AI chatbot widget before adding it to your website</p>
        
        <div class="instructions">
            <h3>ðŸ“Œ How to Use This Page</h3>
            <ol>
                <li>Enter your Chatbot ID below (you can find this in your dashboard)</li>
                <li>Configure the widget appearance settings</li>
                <li>Click "Load Widget" to see it in action</li>
                <li>Copy the generated code to add the widget to your website</li>
            </ol>
        </div>

        <div class="config-section">
            <h3>Widget Configuration</h3>
            <div class="config-item">
                <label for="chatbotId">Chatbot ID:</label>
                <input type="text" id="chatbotId" placeholder="Enter your chatbot ID" style="width: 300px;">
            </div>
            <div class="config-item">
                <label for="position">Position:</label>
                <select id="position">
                    <option value="bottom-right">Bottom Right</option>
                    <option value="bottom-left">Bottom Left</option>
                </select>
            </div>
            <div class="config-item">
                <label for="size">Size:</label>
                <select id="size">
                    <option value="small">Small</option>
                    <option value="medium" selected>Medium</option>
                    <option value="large">Large</option>
                </select>
            </div>
            <div class="config-item">
                <label for="theme">Theme:</label>
                <select id="theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                    <option value="auto">Auto</option>
                </select>
            </div>
            <button onclick="loadWidget()">Load Widget</button>
            <button onclick="removeWidget()">Remove Widget</button>
        </div>

        <div class="section">
            <h3>Generated Code</h3>
            <p>Copy this code and paste it into your website's HTML, just before the closing &lt;/body&gt; tag:</p>
            <div class="code-block" id="generatedCode">
                <!-- Code will be generated here -->
            </div>
        </div>

        <div class="section">
            <h3>Widget Features</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ðŸŽ¨ Customizable Appearance</h4>
                    <p>Choose position, size, and theme to match your website design</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ’¬ Chat Bubble Interface</h4>
                    <p>Floating bubble that users can click to open the chat</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ“± Responsive Design</h4>
                    <p>Works perfectly on desktop, tablet, and mobile devices</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ”§ Easy Integration</h4>
                    <p>Just one script tag - no complex setup required</p>
                </div>
            </div>
        </div>

        <div class="api-section">
            <h3>Advanced API Usage</h3>
            <p>The widget also exposes a JavaScript API for programmatic control:</p>
            <div class="code-block">
// Open the chat widget
ChatbotWidget.open();

// Close the chat widget
ChatbotWidget.close();

// Toggle the chat widget
ChatbotWidget.toggle();

// Remove the widget completely
ChatbotWidget.destroy();
            </div>
        </div>

        <div class="section">
            <h3>Example Website Content</h3>
            <p>This is example content to demonstrate how the widget appears on a real website. The chatbot widget button should appear in the corner of this page based on your configuration.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
    </div>

    <script>
        let currentWidgetScript = null;

        function updateGeneratedCode() {
            const chatbotId = document.getElementById('chatbotId').value;
            const position = document.getElementById('position').value;
            const size = document.getElementById('size').value;
            const theme = document.getElementById('theme').value;
            
            const code = chatbotId ? `<!-- AI Chatbot Widget -->
<script 
  src="${window.location.origin}/widget.js" 
  data-chatbot-id="${chatbotId}"
  data-position="${position}"
  data-size="${size}"
  data-theme="${theme}"
  defer>
<\/script>` : 'Please enter a Chatbot ID';
            
            document.getElementById('generatedCode').textContent = code;
        }

        function loadWidget() {
            const chatbotId = document.getElementById('chatbotId').value;
            
            if (!chatbotId) {
                alert('Please enter a Chatbot ID');
                return;
            }

            // Remove existing widget if any
            removeWidget();

            // Create and load the widget script
            const script = document.createElement('script');
            script.src = `${window.location.origin}/widget.js`;
            script.setAttribute('data-chatbot-id', chatbotId);
            script.setAttribute('data-position', document.getElementById('position').value);
            script.setAttribute('data-size', document.getElementById('size').value);
            script.setAttribute('data-theme', document.getElementById('theme').value);
            script.defer = true;
            
            currentWidgetScript = script;
            document.body.appendChild(script);
            
            updateGeneratedCode();
        }

        function removeWidget() {
            // Use the widget API if available
            if (window.ChatbotWidget && window.ChatbotWidget.destroy) {
                window.ChatbotWidget.destroy();
            }
            
            // Remove the script tag
            if (currentWidgetScript) {
                currentWidgetScript.remove();
                currentWidgetScript = null;
            }
            
            // Remove any widget containers that might be left
            const widgetContainers = document.querySelectorAll('.chatbot-widget-container');
            widgetContainers.forEach(container => container.remove());
        }

        // Update generated code when configuration changes
        document.getElementById('chatbotId').addEventListener('input', updateGeneratedCode);
        document.getElementById('position').addEventListener('change', updateGeneratedCode);
        document.getElementById('size').addEventListener('change', updateGeneratedCode);
        document.getElementById('theme').addEventListener('change', updateGeneratedCode);

        // Initial code generation
        updateGeneratedCode();
    </script>
</body>
</html>
